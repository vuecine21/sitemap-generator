<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Background](#background)
    -   [backgroundEvents](#backgroundevents)
        -   [onMessageHandler](#onmessagehandler)
        -   [onInstalledEvent](#oninstalledevent)
        -   [newSession](#newsession)
        -   [launchGenerator](#launchgenerator)
    -   [sitemapGenerator](#sitemapgenerator)
        -   [start](#start)
        -   [terminate](#terminate)
        -   [status](#status)
        -   [noindex](#noindex)
    -   [centeredWindow](#centeredwindow)
-   [Client-Side Crawler](#client-side-crawler)
    -   [crawler](#crawler)
        -   [appendCodeFragment](#appendcodefragment)
        -   [getRobotsMeta](#getrobotsmeta)
        -   [findLinks](#findlinks)
-   [User Interface](#user-interface)
    -   [setup](#setup)
    -   [processing](#processing)

## Background

The extension background context manages the sitemap generation process.


### backgroundEvents

Listens to relevant events in the browser and responds accordingly

#### onMessageHandler

-   **See: [MessageSender](https://developer.chrome.com/extensions/runtime#type-MessageSender)**

Listen to messages sent from ui pages to background. This is meant to
provide ways for end user to interact with the generator.

**Parameters**

-   `request`  message parameters
    -   `request.start`  starts generator
    -   `request.terminate`  stops generator
    -   `request.status`  gets current processing status
    -   `request.noindex`  tells generator not to index some url, see example below
-   `sender`  details on which window/tab send the message,
-   `sendResponse`  when sender expects a response, this value should be the callback function, see example below.

**Examples**

```javascript
chrome.runtime.sendMessage({ start: config });
```

```javascript
chrome.runtime.sendMessage({ terminate: true });
```

```javascript
chrome.runtime.sendMessage({ noindex: "https://www.google.com" });
```

```javascript
chrome.runtime.sendMessage({ status: true }, function callback(response) {});
```

#### onInstalledEvent

This handler runs when user first installs the extension.
This method launches a welcome page with instructions how to to use the extension.

**Parameters**

-   `details` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** chrome provides this parameter, @see [OnIstalled](https://developer.chrome.com/apps/runtime#event-onInstalled)

#### newSession

When user clicks extension icon, launch the session configuration page.
Also read the url of the active tab and provide that as the default url to crawl on the setup page.

**Parameters**

-   `tab`  current active tab, @see [onClicked](https://developer.chrome.com/extensions/browserAction#event-onClicked)

#### launchGenerator

This function gets called when user is ready to start new crawling session.
At this point in time the extension will make sure the extension has been granted all necessary 
permissions, then start the generator.

**Parameters**

-   `config` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** configration details @see [sitemapGenerator](#sitemapgenerator)
-   `sender`  details on which window/tab send the message, @see [MessageSender](https://developer.chrome.com/extensions/runtime#type-MessageSender)

### sitemapGenerator

This module crawls some website and generates a sitemap for it. The process works as follows:

1.  on start the generator will create a rendering window and
    open a tab for the start url; then wait for http headers response.
2.  If received headers indicate success, generator will load a crawling script in the tab
    that will scan the page looking for a-tag urls.
3.  The content script will send a message back to the generator with a list of urls found on the page.
    the generator will add all new urls to the queue and close the tab
4.  After the initial url has been processed new tabs will open on a set interval to account for possible
    errors and non-response until all urls in the processing queue have been checked
5.  After everything has been cheked the generator will close the window and provide
    the results to the end user

**Parameters**

-   `config` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** configuration options
    -   `config.url` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** the website/app path we want to crawl -- all sitemap entries will be such that they include this base url
    -   `config.requestDomain` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Chrome url match pattern for above url @see [Match Patterns](https://developer.chrome.com/apps/match_patterns)
    -   `config.contenttype_patterns` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** http response content types we want to include in the sitemap
    -   `config.exclude_extension` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** file extensions which should be automatically excluded, example: `['.png','.zip']`
    -   `config.success_codes` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)>** http response status codes which should be regarded as successful
    -   `config.maxTabCount` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** max number of tabs allowed to be open any given time
    -   `config.callback` **[function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** _(optional)_ function to call when sitemap generation has completed

#### start

Initiates crawling of some website

#### terminate

Terminates sitemap generator before it completes naturally

#### status

Get stats about ongoing processing status

#### noindex

Tell generator not to include specific url in the sitemap

**Parameters**

-   `url` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** the url that should not be included in the sitemap

### centeredWindow

Opens centered window in the middle of user's monitor viewport.
If user has multiple monitors this method launches window in the first/leftmost monitor.
This method requires `system.display` permission in `manifest.json`

**Parameters**

-   `width` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** width of the new window (px)
-   `height` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** height of the new window (px)
-   `url` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** url to open
-   `type` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** "normal" or "popup"; defaults to "popup"
-   `focused` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** if window should have focus, default true

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

## Client-Side Crawler

The crawler is responsible for finding urls in in the crawled documents.


### crawler

The generator will load the Crawler module in tabs. The crawler module will then look for urls in the particular tab and send its findings to background in a message. After that the background generator will close the tab.

#### appendCodeFragment

Append some js code fragment in current document DOM

**Parameters**

-   `jsCodeFragment` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** the code you want to execute in the document context

#### getRobotsMeta

Look for "robots" meta tag in the page header and if found return its contents

#### findLinks

Looks for links on the page, then send a message with findings to background page

## User Interface

The UI pages are extension pages allowing user to control the sitemap generation process and interaction with the sitemap generator.

There are currectly two views: 

-   `Setup` - page where user can configure their preferences
-   `Processing` - page shows while sitemap generation is in progress


### setup

This module is used to configure runtime params for sitemap generation

### processing

This module is used to configure runtime params for sitemap generation
