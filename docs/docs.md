<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Background](#background)
    -   [backgroundEvents](#backgroundevents)
        -   [onMessageHandler](#onmessagehandler)
        -   [onInstalledEvent](#oninstalledevent)
        -   [configureGenerator](#configuregenerator)
        -   [launchGenerator](#launchgenerator)
    -   [sitemapGenerator](#sitemapgenerator)
        -   [start](#start)
        -   [terminate](#terminate)
        -   [status](#status)
        -   [noindex](#noindex)
        -   [makeSitemap](#makesitemap)
        -   [onComplete](#oncomplete)
        -   [receiveUrlFromContent](#receiveurlfromcontent)
        -   [onHeadersReceivedHandler](#onheadersreceivedhandler)
        -   [onTabLoadListener](#ontabloadlistener)
        -   [onTabErrorHandler](#ontaberrorhandler)
        -   [addListeners](#addlisteners)
        -   [removeListeners](#removelisteners)
        -   [listAdd](#listadd)
        -   [navigateToNext](#navigatetonext)
    -   [centeredWindow](#centeredwindow)
-   [Content Scripts](#content-scripts)
    -   [crawler](#crawler)
        -   [appendCodeFragment](#appendcodefragment)
        -   [getRobotsMeta](#getrobotsmeta)
        -   [findLinks](#findlinks)
-   [User Interface (UI)](#user-interface-ui)
    -   [setup](#setup)
        -   [getParameterByName](#getparameterbyname)
        -   [onStartButtonClick](#onstartbuttonclick)
    -   [processing](#processing)
        -   [checkStatus](#checkstatus)
        -   [onCloseButtonClick](#onclosebuttonclick)

## Background

The main logic of this extension happens in the background pages of the extension.


### backgroundEvents

Listens to relevant events in the browser and responds accordingly

#### onMessageHandler

Listen to generator termination request

**Parameters**

-   `request`  
-   `sender`  
-   `sendResponse`  

#### onInstalledEvent

This handler runs when user first installs the extension.
It should launch a demo or some other way to explain how the extension works.

**Parameters**

-   `details` **any** chrome provided parameter; indicates if this is new install or update

#### configureGenerator

launch the setup page where user can configure their
session options

**Parameters**

-   `tab`  

#### launchGenerator

When some launch event occurs, this function will

-   determine the url to crawl (i.e. optional parameter or active tab)
-   make sure the extension has permission to access that domain
-   kick off a crawling sessions

**Parameters**

-   `config`  
-   `sender`  

### sitemapGenerator

This module manages the sitemap generation process

The process works as follows:

1.  on start the generator will create a rendering window and
    open a tab for the start url; then wait for http headers response.
2.  If received headers indicate success, generator will load a crawling script in the tab
    that will scan the page looking for a-tag urls.
3.  The content script will send a message back to the generator with a list of urls found on the page.
    the generator will add all new urls to the queue and close the tab
4.  After the initial url has been processed new tabs will open on a set interval to account for possible
    errors and non-response until all urls in the processing queue have been checked
5.  After everything has been cheked the generator will close the window and provide
    the results to the end user

**Parameters**

-   `config` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** configuration options
    -   `config.url` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** the website/app path we want to crawl -- all sitemap entries will be such that they include this base url
    -   `config.contenttype_patterns` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** http response content types we want to include in the sitemap
    -   `config.success_codes` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)>** http response status codes which should be regarded as successful
    -   `config.maxTabCount` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** max number of tabs allowed to be open any given time

#### start

launch the generator

#### terminate

terminate the generator before it exits naturally

#### status

get stats about processing status

#### noindex

when crawling a page the page is set specifically to not be index we must remove it

**Parameters**

-   `url`  

#### makeSitemap

this function creates the sitemap and downloads it, then opens or activates downloads tab

#### onComplete

execute everytime when processing is done, independed of why processing ended

#### receiveUrlFromContent

listen to messages sent from content script back to the generator instance

**Parameters**

-   `request`  
-   `sender`  

#### onHeadersReceivedHandler

listen to headers to determine type and cancel and
close tab immediately if the detected content type is not on the
list of target types

**Parameters**

-   `details`  

#### onTabLoadListener

Listen to incoming webrequest headers

**Parameters**

-   `details`  

#### onTabErrorHandler

if tab errors, cloe it and load next one

**Parameters**

-   `details`  

#### addListeners

add listeners to track response headers and to receive messages
from the opened tabs

#### removeListeners

when processing is done remove all event listeners

#### listAdd

move url to a specific processing queue

**Parameters**

-   `url`  
-   `list`  

#### navigateToNext

take first queued url and create new tab for that url

### centeredWindow

Opens centered window in the middle of user's monitor viewport.

If user has multiple monitors this method launches window in the first/leftmost monitor.

This method requires `system.display` permission in `manifest.json`

**Parameters**

-   `width` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** width of the new window (px)
-   `height` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** height of the new window (px)
-   `url` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** url to open
-   `type` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** "normal" or "popup"; defaults to "popup"
-   `focused`  

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

## Content Scripts

While sitemap generation is ongoing this extension will load content scripts
in the tabs that are being crawled. The purpose of these scripts is to wait for
the page to load then look for anchor tags on the page and send them to the background page.

The background page controls all of hte following aspects: 1) opening tabs,
2) initiating the client side crawling by loading the content script and 3) closing
the tab once the crawling has completed


### crawler

this module gets loaded in a tab and it looks for links on the page

#### appendCodeFragment

Append some fragment of js code into document head

**Parameters**

-   `jsCodeFragment` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** the code you want to execute in the document context

#### getRobotsMeta

look for "robots" meta tag in the page header and if found return its contents

#### findLinks

this function looks for links on the page then sends a message to background bage with the result

## User Interface (UI)

The UI pages are extension pages allowing user to control the sitemap generation process.

There are currectly to views: 

-   `Setup` page, where user can configure their preferences
-   `Processing` window, which shows while sitemap generation is in progress


### setup

this module is used to configure runtime params for sitemap generation

#### getParameterByName

Get some value from querystring

**Parameters**

-   `name` **any** key
-   `url` **any** url to parse (defaults to current)

#### onStartButtonClick

Handle start button click -> this will check user inputs 
and if successful, send message to background page to initiate crawling.

**Parameters**

-   `e` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

### processing

this module is used to configure runtime params for sitemap generation

#### checkStatus

Request information about current processing status from the background
then update the ui to reflect current status.

#### onCloseButtonClick

When user clicks button to terminate send message to background page
to terminate all processing. Closing the rendering window will ultimately have the same effect.

**Parameters**

-   `e`  
